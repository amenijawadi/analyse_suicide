---
title: "Analyse Mondiale des Suicides"
subtitle: "√âtude des Tendances et Facteurs de Risque (1980-2015)"
author: "Jaouadi Amani"
format: 
  revealjs:
    theme: default
    scrollable: true
    transition: slide
    background-transition: fade
    slide-number: true
    show-slide-number: all
    code-fold: true
    code-tools: true
    code-summary: "üìä Afficher le code"
    footer: '<a href="#/title-slide" style="position: fixed; bottom: 10px; right: 10px; z-index: 1000;"><svg width="24" height="24" viewBox="0 0 24 24" fill="#003366"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg></a>'
css: custom.css
execute:
  echo: true
  warning: false
  message: false
---

```{r setup, include=FALSE}
library(tidyverse)
library(scales)
library(plotly)
library(knitr)
library(DT)

theme_set(theme_minimal(base_size = 14))

# Charger les donn√©es
data <- read_csv("data/suicide_data.csv", show_col_types = FALSE)
data_clean <- readRDS("data/suicide_data_clean.rds")
```



::: {.center-content}
# Analyse Mondiale des Suicides

<br>

> *"Pr√®s de 727.000 personnes meurent par suicide chaque ann√©e dans le monde selon l'OMS."* 
> 
> ‚Äî Organisation Mondiale de la Sant√©.

:::

## Probl√©matique

::: {.incremental}
- **-727 000 d√©c√®s** par suicide chaque ann√©e dans le monde.
- **-Une mort toutes les 40 secondes**.
:::

<br>

::: {.question-box .fragment}
Quels sont les **facteurs d√©mographiques**, **temporels** et **g√©ographiques** associ√©s au suicide √† l'√©chelle mondiale ?
:::

## Objectifs de l'√âtude

::: {.columns}
::: {.column width="50%"}
### Analyser

- Tendances temporelles (1980-2015).
- Diff√©rences par sexe.
- Profils par tranche d'√¢ge.
- Disparit√©s g√©ographiques.
:::

::: {.column width="50%"}
### Identifier

- Groupes √† risque.
- P√©riodes critiques.
- Pays les plus touch√©s.
:::
:::

---

# üìÅ Donn√©es Initiales

## Pr√©sentation du Dataset

```{r data_overview}
#| code-fold: false
#| echo: true

glimpse(data)
```

## Statistiques Descriptives Initiales

```{r initial_stats}
#| code-fold: true

# R√©sum√© des variables
data %>% 
  summarise(
    Observations = n(),
    Pays = n_distinct(country),
    Ann√©es = paste(min(year), "-", max(year)),
    `Total suicides` = sum(suicides_no, na.rm = TRUE),
    `NA suicides` = sum(is.na(suicides_no)),
    `NA population` = sum(is.na(population))
  ) %>% 
  mutate(across(everything(), as.character)) %>% 
  pivot_longer(
    everything(),
    names_to = "Indicateur",
    values_to = "Valeur"
  ) %>% 
  kable(caption = "R√©sum√© du dataset initial")
```

## Valeurs Manquantes

```{r missing_values_viz}
#| code-fold: true
#| fig-width: 10
#| fig-height: 6

# Visualisation des valeurs manquantes
data %>% 
  summarise(across(everything(), ~sum(is.na(.)))) %>% 
  pivot_longer(everything(), names_to = "Variable", values_to = "NA_count") %>% 
  mutate(Pourcentage = NA_count / nrow(data) * 100) %>% 
  ggplot(aes(x = reorder(Variable, Pourcentage), y = Pourcentage)) +
  geom_col(fill = "#F44336", alpha = 0.8) +
  geom_text(aes(label = paste0(round(Pourcentage, 2), "%")), 
            hjust = -0.2, size = 4) +
  coord_flip() +
  labs(title = "Pourcentage de valeurs manquantes par variable",
       x = "Variable",
       y = "% de valeurs manquantes") +
  theme_minimal(base_size = 14)
```

---

# üßπ Nettoyage des Donn√©es

## Strat√©gie de Nettoyage

::: {.incremental}
1. **-Suppression des valeurs manquantes** dans `suicides_no` et `population`.
2. **-√âlimination des doublons**.
3. **-Conversion des variables** cat√©gorielles en facteurs ordonn√©s.
4. **-Cr√©ation de variables d√©riv√©es** (taux, d√©cennies).
5. **-D√©tection des valeurs aberrantes** (m√©thode IQR).
:::

## Impact du Nettoyage

```{r cleaning_impact}
#| code-fold: true

# Comparaison avant/apr√®s
tibble(
  √âtape = c("Donn√©es initiales", "Apr√®s nettoyage", "Supprim√©es"),
  `Nombre de lignes` = c(
    nrow(data),
    nrow(data_clean),
    nrow(data) - nrow(data_clean)
  ),
  `Pourcentage` = c(
    100,
    round(nrow(data_clean) / nrow(data) * 100, 2),
    round((nrow(data) - nrow(data_clean)) / nrow(data) * 100, 2)
  )
) %>% 
  kable(format.args = list(big.mark = " "),
        caption = "Impact du nettoyage sur le dataset")
```

---

# üìà Analyse Temporelle

## √âvolution Globale (1980-2015)

```{r temporal_trend}
#| code-fold: true
#| fig-width: 12
#| fig-height: 7

trend_yearly <- data_clean %>% 
  group_by(year) %>% 
  summarise(
    total_suicides = sum(suicides_no),
    total_population = sum(population),
    taux_moyen = (total_suicides / total_population) * 100000,
    .groups = "drop"
  )

p <- ggplot(trend_yearly, aes(x = year, y = taux_moyen)) +
  geom_area(fill = "#F44336", alpha = 0.3) +
  geom_line(color = "#C62828", size = 1.5) +
  geom_point(color = "#C62828", size = 3) +
  scale_x_continuous(breaks = seq(1980, 2015, 5)) +
  labs(title = "√âvolution du taux de suicide mondial (1980-2015)",
       subtitle = "Pour 100 000 habitants",
       x = "Ann√©e",
       y = "Taux pour 100k habitants") +
  theme_minimal(base_size = 14) +
  theme(plot.title = element_text(face = "bold", size = 16))

ggplotly(p) %>% 
  layout(hovermode = "x unified")
```

## Variations Annuelles

```{r annual_variations}
#| code-fold: true
#| fig-width: 12
#| fig-height: 7

trend_yearly <- trend_yearly %>% 
  mutate(variation_pct = (total_suicides - lag(total_suicides)) / lag(total_suicides) * 100)

ggplot(trend_yearly %>% filter(!is.na(variation_pct)), 
       aes(x = year, y = variation_pct)) +
  geom_col(aes(fill = variation_pct > 0), alpha = 0.8) +
  geom_hline(yintercept = 0, linetype = "dashed", size = 1) +
  scale_fill_manual(values = c("TRUE" = "#F44336", "FALSE" = "#4CAF50"),
                    labels = c("Augmentation", "Diminution")) +
  scale_x_continuous(breaks = seq(1980, 2015, 5)) +
  labs(title = "Variation annuelle du nombre de suicides",
       subtitle = "Taux de croissance par rapport √† l'ann√©e pr√©c√©dente",
       x = "Ann√©e",
       y = "Variation (%)",
       fill = "Type") +
  theme_minimal(base_size = 14)
```

## Comparaison par D√©cennie

```{r decade_comparison}
#| code-fold: true
#| fig-width: 10
#| fig-height: 6

data_clean %>% 
  group_by(decennie) %>% 
  summarise(
    total = sum(suicides_no),
    taux = (sum(suicides_no) / sum(population)) * 100000,
    .groups = "drop"
  ) %>% 
  ggplot(aes(x = decennie, y = taux, fill = decennie)) +
  geom_col(alpha = 0.8, width = 0.7) +
  geom_text(aes(label = round(taux, 1)), vjust = -0.5, size = 5, fontface = "bold") +
  scale_fill_brewer(palette = "Set2") +
  labs(title = "Taux de suicide par d√©cennie",
       x = "D√©cennie",
       y = "Taux pour 100k habitants") +
  theme_minimal(base_size = 14) +
  theme(legend.position = "none",
        plot.title = element_text(face = "bold", size = 16))
```

---

# üë• Analyse par Sexe

## R√©partition Globale

```{r sex_distribution}
#| code-fold: true
#| fig-width: 10
#| fig-height: 8

data_clean %>% 
  group_by(sex) %>% 
  summarise(total = sum(suicides_no), .groups = "drop") %>% 
  mutate(pourcentage = total / sum(total) * 100) %>% 
  ggplot(aes(x = "", y = total, fill = sex)) +
  geom_col(width = 1, color = "white", size = 2) +
  coord_polar(theta = "y") +
  geom_text(aes(label = paste0(round(pourcentage, 1), "%\n", 
                                format(total, big.mark = " "))),
            position = position_stack(vjust = 0.5),
            size = 7, fontface = "bold", color = "white") +
  scale_fill_manual(values = c("Homme" = "#2196F3", "Femme" = "#E91E63")) +
  labs(title = "R√©partition des suicides par sexe (1980-2015)",
       fill = "Sexe") +
  theme_void(base_size = 14) +
  theme(plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
        legend.position = "bottom")
```

## √âvolution par Sexe - Interactif

```{r sex_evolution}
#| code-fold: true
#| fig-width: 12
#| fig-height: 7

sex_trend <- data_clean %>% 
  group_by(year, sex) %>% 
  summarise(
    total_suicides = sum(suicides_no),
    total_population = sum(population),
    taux = (total_suicides / total_population) * 100000,
    .groups = "drop"
  )

p <- ggplot(sex_trend, aes(x = year, y = taux, color = sex)) +
  geom_line(size = 1.5) +
  geom_point(size = 3) +
  scale_color_manual(values = c("Homme" = "#2196F3", "Femme" = "#E91E63")) +
  scale_x_continuous(breaks = seq(1980, 2015, 5)) +
  labs(title = "√âvolution du taux de suicide par sexe",
       x = "Ann√©e",
       y = "Taux pour 100k habitants",
       color = "Sexe") +
  theme_minimal(base_size = 14) +
  theme(legend.position = "top",
        plot.title = element_text(face = "bold", size = 16))

ggplotly(p)
```

## Ratio Homme/Femme

```{r sex_ratio}
#| code-fold: true
#| fig-width: 12
#| fig-height: 7

trend_sex <- data_clean %>% 
  group_by(year, sex) %>% 
  summarise(total_suicides = sum(suicides_no), .groups = "drop")

ratio_temporel <- trend_sex %>% 
  pivot_wider(names_from = sex, values_from = total_suicides) %>% 
  mutate(ratio_HF = Homme / Femme)

ggplot(ratio_temporel, aes(x = year, y = ratio_HF)) +
  geom_line(color = "#9C27B0", size = 1.5) +
  geom_point(color = "#9C27B0", size = 3) +
  geom_hline(yintercept = mean(ratio_temporel$ratio_HF), 
             linetype = "dashed", color = "#F44336", size = 1) +
  annotate("text", x = 2010, y = mean(ratio_temporel$ratio_HF) + 0.15,
           label = paste("Moyenne:", round(mean(ratio_temporel$ratio_HF), 2)),
           color = "#F44336", size = 5, fontface = "bold") +
  scale_x_continuous(breaks = seq(1980, 2015, 5)) +
  labs(title = "Ratio Homme/Femme dans le temps",
       subtitle = "Nombre de suicides masculins pour 1 suicide f√©minin",
       x = "Ann√©e",
       y = "Ratio H/F") +
  theme_minimal(base_size = 14) +
  theme(plot.title = element_text(face = "bold", size = 16))
```

---

# üë∂üë¥ Analyse par √Çge

## Distribution par Tranche d'√Çge

```{r age_distribution}
#| code-fold: true
#| fig-width: 12
#| fig-height: 7

data_clean %>% 
  group_by(age) %>% 
  summarise(total = sum(suicides_no), .groups = "drop") %>% 
  mutate(pourcentage = total / sum(total) * 100) %>% 
  ggplot(aes(x = age, y = total, fill = age)) +
  geom_col(alpha = 0.8) +
  geom_text(aes(label = paste0(round(pourcentage, 1), "%")),
            vjust = -0.5, size = 5, fontface = "bold") +
  scale_y_continuous(labels = comma) +
  scale_fill_viridis_d(option = "plasma") +
  labs(title = "R√©partition des suicides par tranche d'√¢ge",
       subtitle = "Total mondial 1980-2015",
       x = "Tranche d'√¢ge",
       y = "Nombre de suicides") +
  theme_minimal(base_size = 14) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.position = "none",
        plot.title = element_text(face = "bold", size = 16))
```

## Profil de Risque par √Çge

```{r age_risk_profile}
#| code-fold: true
#| fig-width: 12
#| fig-height: 7

data_clean %>% 
  group_by(age) %>% 
  summarise(taux = mean(taux_suicide_100k), .groups = "drop") %>% 
  ggplot(aes(x = age, y = taux, group = 1)) +
  geom_line(color = "#F44336", size = 2) +
  geom_point(size = 5, color = "#F44336") +
  geom_area(alpha = 0.3, fill = "#F44336") +
  labs(title = "Profil du risque suicidaire par √¢ge",
       subtitle = "Taux moyen pour 100 000 habitants",
       x = "Tranche d'√¢ge",
       y = "Taux pour 100k habitants") +
  theme_minimal(base_size = 14) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        plot.title = element_text(face = "bold", size = 16))
```

## Interaction √Çge √ó Sexe

```{r age_sex_heatmap}
#| code-fold: true
#| fig-width: 10
#| fig-height: 8

data_clean %>% 
  group_by(age, sex) %>% 
  summarise(taux = mean(taux_suicide_100k), .groups = "drop") %>% 
  ggplot(aes(x = sex, y = age, fill = taux)) +
  geom_tile(color = "white", size = 2) +
  geom_text(aes(label = round(taux, 1)), 
            color = "white", fontface = "bold", size = 6) +
  scale_fill_gradient2(low = "#2196F3", mid = "#FFC107", high = "#F44336",
                       midpoint = 25) +
  labs(title = "Taux moyen de suicide : √Çge √ó Sexe",
       x = "Sexe",
       y = "Tranche d'√¢ge",
       fill = "Taux (100k)") +
  theme_minimal(base_size = 14) +
  theme(plot.title = element_text(face = "bold", size = 16))
```

---

# üåç Analyse G√©ographique

## Top 15 Pays - Interactif

```{r top15_countries}
#| code-fold: true
#| fig-width: 12
#| fig-height: 8

top15_pays <- data_clean %>% 
  group_by(country) %>% 
  summarise(
    total_suicides = sum(suicides_no),
    total_population = sum(population),
    taux_moyen = (total_suicides / total_population) * 100000,
    .groups = "drop"
  ) %>% 
  arrange(desc(taux_moyen)) %>% 
  head(15)

p <- ggplot(top15_pays, aes(x = reorder(country, taux_moyen), y = taux_moyen, 
                            text = paste0(country, "<br>Taux: ", round(taux_moyen, 1)))) +
  geom_segment(aes(x = reorder(country, taux_moyen), 
                   xend = reorder(country, taux_moyen),
                   y = 0, yend = taux_moyen),
               color = "grey50", size = 1.2) +
  geom_point(size = 5, color = "#F44336") +
  coord_flip() +
  labs(title = "Top 15 des pays avec les taux de suicide les plus √©lev√©s",
       subtitle = "Taux moyen 1980-2015 pour 100 000 habitants",
       x = NULL,
       y = "Taux pour 100k habitants") +
  theme_minimal(base_size = 14) +
  theme(plot.title = element_text(face = "bold", size = 16))

ggplotly(p, tooltip = "text")
```

## Analyse par R√©gion

```{r regional_analysis}
#| code-fold: true
#| fig-width: 12
#| fig-height: 7

data_regions <- data_clean %>% 
  mutate(
    region = case_when(
      country %in% c("France", "Germany", "United Kingdom", "Italy", "Spain", 
                     "Poland", "Netherlands", "Belgium", "Austria", "Switzerland") ~ "Europe Ouest",
      country %in% c("Russia", "Ukraine", "Belarus", "Hungary", "Lithuania") ~ "Europe Est",
      country %in% c("United States", "Canada", "Mexico") ~ "Am√©rique Nord",
      country %in% c("Brazil", "Argentina", "Chile", "Colombia") ~ "Am√©rique Sud",
      country %in% c("China", "Japan", "South Korea", "Thailand") ~ "Asie",
      country %in% c("Australia", "New Zealand") ~ "Oc√©anie",
      TRUE ~ "Autre"
    )
  )

data_regions %>% 
  group_by(region) %>% 
  summarise(
    taux_moyen = (sum(suicides_no) / sum(population)) * 100000,
    .groups = "drop"
  ) %>% 
  ggplot(aes(x = reorder(region, taux_moyen), y = taux_moyen, fill = region)) +
  geom_col(alpha = 0.8) +
  geom_text(aes(label = round(taux_moyen, 1)), 
            hjust = -0.2, size = 5, fontface = "bold") +
  coord_flip() +
  scale_fill_brewer(palette = "Set3") +
  labs(title = "Taux de suicide moyen par r√©gion du monde",
       x = NULL,
       y = "Taux pour 100k habitants") +
  theme_minimal(base_size = 14) +
  theme(legend.position = "none",
        plot.title = element_text(face = "bold", size = 16))
```

---

# üí° Conclusions et Synth√®se

## üîπ Principaux Constats

- **Sexe masculin** : 3 √† 4 fois plus touch√© que les femmes.
- **√Çge avanc√©** : Seniors (55+) √† risque √©lev√©.
- **Disparit√©s g√©ographiques** : Europe de l'Est plus concern√©e.
- **Variations temporelles** : P√©riodes de crise (ann√©es 80-90) ; baisse globale post-2000.

## üîπ Implications pour la Sant√© Publique

1. **Pr√©vention cibl√©e** : Adapter les strat√©gies aux groupes √† risque.
2. **Surveillance renforc√©e** : Am√©liorer la collecte de donn√©es.
3. **Politiques efficaces** : S'inspirer des pays ayant r√©duit les taux.

## üîπ Limites et Perspectives

- Facteurs socio-√©conomiques non inclus.
- **Perspectives** : Analyse des facteurs socio-√©conomiques, impact des politiques, mod√©lisation pr√©dictive.

---

::: {.center-content}


*"La pr√©vention du suicide est l'affaire de tous"*

<br>

üìß Contact : amani.jaouadi@polytechnicien.tn  
üåê GitHub : https://github.com/amenijawadi

:::

